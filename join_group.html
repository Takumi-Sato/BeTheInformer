<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>密告中！</title>
</head>
<body>
    <!-- ゲームタイトルロゴ -->
    <div class="logo"><h1><img src="01.png"></h1></div>
    
    <h1>参加グループ選択</h1>
    <form class="choose_group" method="get">

    </form>
    <button class="submit" onclick="location.href='wait_guest.html'">参加する</button>
    <script
  src="https://code.jquery.com/jquery-2.2.4.min.js"
  integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
  crossorigin="anonymous"></script>
  <script type="text/javascript">
    
    $.ajax({
        url: "http://192.168.2.103:8887/test_join_group.json",
    //type: "post",
        dataType: "json",
        success: function(res){
            Display(res);
        },
        error: function(res){
        console.log("ERROR");
        }
    });
    
    function Display(res) {
        var data = res.group_names;
        console.log(data);
        /*参加者の表示*/
        if(data.length == 0){
          var dom = $("<p>参加できるグループはありません</p>");
          $(".choose_group").append(dom);
        }else{
          for (var i=0; i<data.length;i++){
            var group_name = data[i];
            var dom = $("<input type='radio' name='group_name' value=" +group_name+ ">" +group_name+ "</input><br/>");
            console.log(group_name);
            $(".choose_group").append(dom);
          }
        }
      }

      $(".submit").on("click", doSubmit);
      function doSubmit () {
        var data = $('form').serializeArray();
        console.log(parseJson(data));
        /*data = parseJson(data);
      $.ajax({
        type:          'post',
        dataType:      'json',
        contentType:   'application/json',
        scriptCharset: 'utf-8',
        data:          JSON.stringify(data)
      })*/
      }
      
      var parseJson = function(data) {
        var returnJson = {};
        for (idx = 0; idx < data.length; idx++) {
          returnJson[data[idx].name] = data[idx].value
        }
        //console.log(idx);
        return returnJson;
      }
  </script>
</body>
</html>